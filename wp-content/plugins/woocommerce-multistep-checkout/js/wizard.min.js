jQuery(document).ready(function(e){function i(i){if(result=jQuery(".form-row#"+i+"_postcode_field").length>0&&0!=jQuery("#"+i+"_postcode").val()&&jQuery("#"+i+"_country").length>0&&0!=jQuery("#"+i+"_country").val(),result){var r={action:"valid_post_code",country:jQuery("#"+i+"_country").val(),postCode:jQuery("#"+i+"_postcode").val()};e("#wizard").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),jQuery.post(wmc_wizard.ajaxurl,r,function(r){return e("#wizard").unblock(),0==r?(jQuery("#"+i+"_postcode").parent().removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),!1):!0})}}function r(){var i=!1;if(jQuery("form.checkout").valid()&&(i=!0),0==wmc_wizard.isAuthorizedUser&&(e("#shipping_state_field").is(":visible")&&e("#shipping_state").is(["required"])&&(e("#shipping_state_field").hasClass("woocommerce-validated")?(e("#shipping_state_field").find("label.error-class").remove(),e("#s2id_shipping_state").removeClass("invalid-state")):(e("#shipping_state_field").has("label.error-class").length||(e("#s2id_shipping_state").addClass("invalid-state"),e("#shipping_state_field").append('<label class="error-class">'+wmc_wizard.error_msg+"</label>")),i=!1)),e("#billing_state_field").is(":visible")&&e("#billing_state").is(["required"])&&(e("#billing_state_field").hasClass("woocommerce-validated")?(e("#billing_state_field").find("label.error-class").remove(),e("#s2id_billing_state").removeClass("invalid-state")):(e("#billing_state_field").has("label.error-class").length||(e("#s2id_billing_state").addClass("invalid-state"),e("#billing_state_field").append('<label class="error-class">'+wmc_wizard.error_msg+"</label>")),i=!1))),wmc_wizard.isAuthorizedUser&&(e("#billing_state_field").is(":visible")&&e("#billing_state").is(["required"])&&(""==e.trim(e("#billing_state").val())?(e("#s2id_billing_state").addClass("invalid-state"),e("#billing_state_field").has(".error-class").length||e("#billing_state_field").has("label.error").length||e("#billing_state_field label.error").is(":visible")||e("#billing_state_field").append('<label class="error-class">'+wmc_wizard.error_msg+"</label>"),i=!1):(e("#billing_state_field").find("label.error-class").remove(),e("#s2id_billing_state").removeClass("invalid-state"))),e("#shipping_state_field").is(":visible")&&(e("#shipping_state").is(["required"])?""==e.trim(e("#shipping_state").val())&&(e("#s2id_shipping_state").addClass("invalid-state"),e("#shipping_state_field").has("label.error").length||e("#shipping_state_field label.error").is(":visible")||e("#shipping_state_field").append('<label class="error-class">'+wmc_wizard.error_msg+"</label>"),i=!1):(e("#shipping_state_field").find("label.error-class").remove(),e("#s2id_shipping_state").removeClass("invalid-state")))),"true"==wmc_wizard.zipcode_validation&&jQuery("#billing_postcode").closest("#billing_postcode_field").hasClass("woocommerce-invalid")&&(i=!1),e("#billing_phone").length){var r=jQuery("#billing_phone").val();r=r.replace(/[\s\#0-9_\-\+\(\)]/g,""),r=jQuery.trim(r),r.length>0&&(i=!1,jQuery("#billing_phone_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),e("#billing_phone_field").has("label.error-class").length||e("#billing_phone_field").append('<label class="error-class">invalid phone number</label>'))}return"true"==wmc_wizard.zipcode_validation&&jQuery("#ship-to-different-address-checkbox").is(":checked")&&jQuery("#ship-to-different-address-checkbox").is(":visible")&&(jQuery("#shipping_postcode").closest("#shipping_postcode_field").hasClass("woocommerce-validated")||(i=!1)),s()||(i=!1),i}function n(e){jQuery("form.login input#"+e).parent().removeClass("woocommerce-validated"),jQuery("form.login input#"+e).parent().addClass("woocommerce-invalid woocommerce-invalid-required-field"),jQuery("form.login input#"+e).parent().addClass("validate-required")}function t(){return validate=!1,e("#wizard div.current").find("form.checkout_coupon").length&&(validate=!0),validate}function l(){jQuery(".coupon-step").hasClass("current")?"fade"===wmc_wizard.transitionEffect?jQuery("form.checkout_coupon").appendTo(".coupon-step").fadeIn(100):jQuery("form.checkout_coupon").appendTo(".coupon-step").slideDown(100):jQuery(".coupon-step").length&&e("form.checkout_coupon").hide().appendTo(".container-coupon-login-form")}function o(){jQuery("true"==wmc_wizard.include_register_form)?target_form="#customer_login":target_form="form.woocommerce-form-login",jQuery(".login-step").hasClass("current")?"fade"==wmc_wizard.transitionEffect?jQuery(target_form).appendTo(".login-step").fadeIn(100):jQuery(target_form).appendTo(".login-step").slideDown(100):jQuery(".login-step").length&&jQuery(target_form).hide().appendTo(".container-coupon-login-form")}function s(){var i=!0;return jQuery('input[name="legal"]').length&&jQuery('input[name="legal"]').is(":visible")&&(jQuery('input[name="legal"]').is(":checked")?(jQuery('input[name="legal"]').parent().removeAttr("style"),jQuery(".terms-error").remove(),i=!0):(jQuery('input[name="legal"]').attr("required","required"),jQuery(".terms").css("border","1px solid #8a1f11"),e(".terms-error").length||jQuery('<p class="terms-error">'+wmc_wizard.terms_error+"</p>").insertAfter(".wc-terms-and-conditions"),i=!1)),jQuery('input[name="terms"]').length&&jQuery('input[name="terms"]').is(":visible")&&(jQuery('input[name="terms"]').is(":checked")?(jQuery('input[name="terms"]').parent().removeAttr("style"),jQuery(".terms-error").remove(),i=!0):(jQuery('input[name="terms"]').attr("required","required"),jQuery('input[name="terms"]').parent().css("border","1px solid #8a1f11"),e(".terms-error").length||jQuery('<p class="terms-error">'+wmc_wizard.terms_error+"</p>").insertAfter(".wc-terms-and-conditions"),i=!1)),i}if(e(".wmc-loading-img").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),jQuery("form.checkout").show(),jQuery("form.checkout .validate-required :input").attr("required","required"),jQuery("form.checkout .validate-email .input-text").addClass("email"),0==wmc_wizard.isAuthorizedUser&&"false"!=wmc_wizard.include_login&&"no"!=wmc_wizard.woo_include_login)var d=wmc_wizard.no_account_btn;else var d=wmc_wizard.next;var d;"true"==wmc_wizard.wmc_remove_numbers?jQuery("#wizard").steps({transitionEffect:wmc_wizard.transitionEffect,stepsOrientation:wmc_wizard.stepsOrientation,enableAllSteps:!1,enablePagination:wmc_wizard.enablePagination,titleTemplate:"#title#",labels:{next:d,previous:wmc_wizard.previous,finish:wmc_wizard.finish},onInit:function(i,r){e(".wmc-loading-img").hide(),e(".actions > ul > li:first-child").attr("style","display:none")},onStepChanging:function(i,n,l){return e(this).trigger("onStepChanging",[a=i,b=n,c=l]),0==n&&0==wmc_wizard.isAuthorizedUser&&"false"!=wmc_wizard.include_login&&"no"!=wmc_wizard.woo_include_login||n>l||t()?!0:r()},onStepChanged:function(i,r,n){e(this).trigger("onStepChanged",[a=i,b=r,c=n]),r>0?e(".actions > ul > li:first-child").attr("style",""):e(".actions > ul > li:first-child").attr("style","display:none"),0==r&&0==wmc_wizard.isAuthorizedUser&&"false"!=wmc_wizard.include_login&&"no"!=wmc_wizard.woo_include_login?(jQuery('form.checkout a[href="#next"]').html(wmc_wizard.no_account_btn),jQuery('form.checkout a[href="#previous"]').hide()):(jQuery('form.checkout a[href="#next"]').html(wmc_wizard.next),jQuery('form.checkout a[href="#previous"]').show())},onFinishing:function(i,r){e(this).trigger("onFinishing")}}):jQuery("#wizard").steps({transitionEffect:wmc_wizard.transitionEffect,stepsOrientation:wmc_wizard.stepsOrientation,enableAllSteps:!1,enablePagination:wmc_wizard.enablePagination,labels:{next:d,previous:wmc_wizard.previous,finish:wmc_wizard.finish},onInit:function(i,r){e(".wmc-loading-img").hide(),e(".actions > ul > li:first-child").attr("style","display:none")},onStepChanging:function(i,n,l){return e(this).trigger("onStepChanging",[a=i,b=n,c=l]),0==n&&0==wmc_wizard.isAuthorizedUser&&"false"!=wmc_wizard.include_login&&"no"!=wmc_wizard.woo_include_login||n>l||t()?!0:r()},onStepChanged:function(i,r,n){e(this).trigger("onStepChanged",[a=r,b=r,c=n]),r>0?e(".actions > ul > li:first-child").attr("style",""):e(".actions > ul > li:first-child").attr("style","display:none"),0==r&&0==wmc_wizard.isAuthorizedUser&&"false"!=wmc_wizard.include_login&&"no"!=wmc_wizard.woo_include_login?(jQuery('form.checkout a[href="#next"]').html(wmc_wizard.no_account_btn),jQuery('form.checkout a[href="#previous"]').hide()):(jQuery('form.checkout a[href="#next"]').html(wmc_wizard.next),jQuery('form.checkout a[href="#previous"]').show())},onFinishing:function(i,r){e(this).trigger("onFinishing")}}),jQuery.extend(jQuery.validator.messages,{required:wmc_wizard.error_msg,email:wmc_wizard.email_error_msg}),jQuery(".actions > ul li:last a").addClass("finish-btn"),jQuery(".finish-btn").click(function(){jQuery("#place_order").trigger("click")});var u=jQuery("#wizard ul[role='tablist'] > li").length;if(5==u&&jQuery("#wizard").addClass("five-steps"),3==u&&jQuery("#wizard").addClass("three-steps"),"vertical"!=wmc_wizard.stepsOrientation){var u=jQuery("#wizard ul[role='tablist'] > li").length,m=100/u;e("#wizard .steps ul li").css("width",m+"%")}"true"==wmc_wizard.zipcode_validation&&(jQuery("body").on("change","#billing_country",function(){e("#billing_country").is(":visible")&&i("billing")}),jQuery("body").on("blur","#billing_postcode",function(){e("#billing_postcode").is(":visible")&&i("billing")}),jQuery("body").on("change","#shipping_country",function(){e("#shipping_country").is(":visible")&&i("shipping")}),jQuery("body").on("blur","#shipping_postcode",function(){e("#shipping_postcode").is(":visible")&&i("shipping")})),jQuery(document).on("click","#wizard form.login .button, #wizard .woocommerce-form-login .button",function(i){if("false"!=wmc_wizard.include_login){i.preventDefault();var r="form.login",a=!1;if(0==jQuery(r+" input#username").val()&&(a=!0,n("username")),0==jQuery(r+" input#password").val()&&(a=!0,n("password")),0!=a)return!1;0==jQuery(r+" input#rememberme").is(":checked")?rememberme=!1:rememberme=!0,e("#wizard").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var t={action:"wmc_check_user_login",username:jQuery(r+" input#username").val(),password:jQuery(r+" input#password").val(),rememberme:rememberme,_ajax_nonce:wmc_wizard.login_nonce};jQuery.post(wmc_wizard.ajaxurl,t,function(i){e("#wizard").unblock(),"successfully"==i?location.reload():e("form.login > .error-msg").length||jQuery("form.login").prepend(i)})}}),jQuery(document).on("click","#wizard form.register .button",function(i){i.preventDefault(),e("#wizard").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var r={action:"wmc_user_registration",username:jQuery.trim(jQuery("#reg_username").val()),email:jQuery.trim(jQuery("#reg_email").val()),password:jQuery.trim(jQuery("#reg_password").val()),_ajax_nonce:wmc_wizard.register_nonce};jQuery.post(wmc_wizard.ajaxurl,r,function(i){e("#wizard").unblock(),"success"==i?location.reload():(jQuery(".register_form_error").remove(),jQuery("form.register").prepend(i))})}),e("#billing_phone").on("blur input change",function(){if(e("#billing_phone").length&&e(this).prop("required")){var i=jQuery("#billing_phone").val();i=i.replace(/[\s\#0-9_\-\+\(\)]/g,""),i=jQuery.trim(i),""!=e(this).val()&&e("#billing_phone").next("label.error").remove(),i.length>0?(jQuery("#billing_phone_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),e("#billing_phone_field").has("label.error-class").length||e("#billing_phone_field").append('<label class="error-class">'+wmc_wizard.phone_error_msg+"</label>")):e("#billing_phone_field").has("label.error-class").length&&e("#billing_phone").next().remove()}}),e(window).keydown(function(e){return 13==e.keyCode?(e.preventDefault(),!1):void 0}),e("form.checkout").submit(function(i){e(".terms-error").is(":visible")&&(i.preventDefault(),i.stopImmediatePropagation())}),jQuery("#wizard").on("onStepChanged",function(e,i,r){l(),o()}),jQuery("#wizard").on("onFinishing",function(){s()})});